[
  {
    "objectID": "r.html#what-is-analysis-of-variance",
    "href": "r.html#what-is-analysis-of-variance",
    "title": "Analysis of Variance in R",
    "section": "What is Analysis of Variance?",
    "text": "What is Analysis of Variance?\nAnalysis of Variance (ANOVA) compares the means of some dependent variable across three or more groups of an independent variable to determine if the group means are statistically different."
  },
  {
    "objectID": "r.html#when-would-i-use-anova",
    "href": "r.html#when-would-i-use-anova",
    "title": "Analysis of Variance in R",
    "section": "When would I use ANOVA?",
    "text": "When would I use ANOVA?\nYou might use ANOVA when…\n\nYou have a categorical independent variable with three or more factors (levels), and\nA continuous, dependent variable you are interested in measuring."
  },
  {
    "objectID": "r.html#when-would-i-use-anova-1",
    "href": "r.html#when-would-i-use-anova-1",
    "title": "Analysis of Variance in R",
    "section": "When would I use ANOVA?",
    "text": "When would I use ANOVA?\nExamples:\n\nComparing three diets, based on how much weight a person lost.\nDetermining if there is a difference in how 10 different medications affect blood pressure.\nAnalyzing the effects of three light levels, fertilizer or not, and their interaction on a plant’s growth."
  },
  {
    "objectID": "r.html#example",
    "href": "r.html#example",
    "title": "Analysis of Variance in R",
    "section": "Example",
    "text": "Example\nLet’s look at an example for how we would run an ANOVA in R. Say we have the following scenario:\n\n\nWe want to look at how three different light levels (low, medium, high) affect the growth of a plant (in centimeters).\nIn a greenhouse, there are 18 grow lights; six with each light level\n18 separate plants are randomly assigned to each grow light\nAll other conditions are constant across all plants, and after 12 weeks, total growth is measured"
  },
  {
    "objectID": "r.html#example-data",
    "href": "r.html#example-data",
    "title": "Analysis of Variance in R",
    "section": "Example Data",
    "text": "Example Data\nSay we have the following sample data.\n\n# Reading in data\ngrowth &lt;- data.frame(plant = c(\"plant 1\",\"plant 2\",\"plant 3\",\"plant 4\",\"plant 5\",\"plant 6\"),\n                     low = c(18.51,5.99,11.02,7.06,14.96,13.56),\n                     med = c(19.19,19.09,17.90,21.47,20.38,14.58),\n                     high = c(19.23,24.27,27.34,22.23,22.92,28.77))\ngrowth\n\n    plant   low   med  high\n1 plant 1 18.51 19.19 19.23\n2 plant 2  5.99 19.09 24.27\n3 plant 3 11.02 17.90 27.34\n4 plant 4  7.06 21.47 22.23\n5 plant 5 14.96 20.38 22.92\n6 plant 6 13.56 14.58 28.77\n\n\n\nNote: This data is in wide format, but we’ll need it in long format in order to analyze it."
  },
  {
    "objectID": "r.html#quick-tip-reformatting-data",
    "href": "r.html#quick-tip-reformatting-data",
    "title": "Analysis of Variance in R",
    "section": "Quick Tip! Reformatting Data",
    "text": "Quick Tip! Reformatting Data\nThe pivot_longer() function from the tidyr package easily converts data from wide format to long format.\n\nInstall the package (if you haven’t already) by pasting the following code into your console.\n\ninstall.packages(\"tidyr\")"
  },
  {
    "objectID": "r.html#quick-tip-reformatting-data-1",
    "href": "r.html#quick-tip-reformatting-data-1",
    "title": "Analysis of Variance in R",
    "section": "Quick Tip! Reformatting Data",
    "text": "Quick Tip! Reformatting Data\nNext, use pivot_longer() to restructure the data.\n\n# Putting data in long format\nlibrary(tidyr)\ngrowth_long &lt;- pivot_longer(data = growth,\n                            cols = \"low\":\"high\",\n                            names_to = \"light_level\",\n                            values_to = \"growth\")\nhead(growth_long)\n\n# A tibble: 6 × 3\n  plant   light_level growth\n  &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;\n1 plant 1 low          18.5 \n2 plant 1 med          19.2 \n3 plant 1 high         19.2 \n4 plant 2 low           5.99\n5 plant 2 med          19.1 \n6 plant 2 high         24.3"
  },
  {
    "objectID": "r.html#anova-assumptions",
    "href": "r.html#anova-assumptions",
    "title": "Analysis of Variance in R",
    "section": "ANOVA Assumptions",
    "text": "ANOVA Assumptions\nTo use ANOVA, certain assumptions must be met, or results will not be reliable.\n\n\nData is normally distributed\nObservations are independent of each other\nVariances for each group are approximately equal"
  },
  {
    "objectID": "r.html#anova-assumptions-1",
    "href": "r.html#anova-assumptions-1",
    "title": "Analysis of Variance in R",
    "section": "ANOVA Assumptions",
    "text": "ANOVA Assumptions\n\nHere, each group is normally distributed with different means and equal variance."
  },
  {
    "objectID": "r.html#anova-assumptions-2",
    "href": "r.html#anova-assumptions-2",
    "title": "Analysis of Variance in R",
    "section": "ANOVA Assumptions",
    "text": "ANOVA Assumptions\n\nHere, groups are normally distributed with different means, but variances are unequal."
  },
  {
    "objectID": "r.html#checking-for-normality",
    "href": "r.html#checking-for-normality",
    "title": "Analysis of Variance in R",
    "section": "Checking for Normality",
    "text": "Checking for Normality\nIn a general sense, we want to check that our data approximately follows the normal distribution."
  },
  {
    "objectID": "r.html#checking-for-normality-1",
    "href": "r.html#checking-for-normality-1",
    "title": "Analysis of Variance in R",
    "section": "Checking for Normality",
    "text": "Checking for Normality\nLet’s see if our data looks normal by making a histogram.\n\nhist(growth_long$growth)\n\n\n\nOur data looks fairly normal, so we can proceed with an ANOVA. We will assume that the variances are approximately equal."
  },
  {
    "objectID": "r.html#how-does-anova-work",
    "href": "r.html#how-does-anova-work",
    "title": "Analysis of Variance in R",
    "section": "How does ANOVA work?",
    "text": "How does ANOVA work?\nANOVA breaks down total variance of the response variable into two components:\n\n\nWithin-group variance: How much do individual units within a group vary from each other?\nBetween-group variance: How much do the different groups vary from each other?\n\n\n\nIf between-group variance is larger, this often suggests that the group means are different."
  },
  {
    "objectID": "r.html#anova-hypotheses",
    "href": "r.html#anova-hypotheses",
    "title": "Analysis of Variance in R",
    "section": "ANOVA Hypotheses",
    "text": "ANOVA Hypotheses\nAn ANOVA tests the following hypotheses:\n\n\n\\(H_0:\\) All group means are equal.\n\\(H_A:\\) At least one group mean is different.\n\n\n\nWe test these hypotheses with an F-test.\n\nIf we get a p-value &lt; 0.05, then we have evidence in favor of \\(H_A\\)"
  },
  {
    "objectID": "r.html#anova-in-r",
    "href": "r.html#anova-in-r",
    "title": "Analysis of Variance in R",
    "section": "ANOVA In R",
    "text": "ANOVA In R\n\n# Run an ANOVA\nmodel &lt;- aov(growth ~ light_level, data = growth_long)\nsummary(model)\n\n            Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nlight_level  2  454.6  227.29   16.68 0.000154 ***\nResiduals   15  204.3   13.62                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "r.html#interpreting-the-results",
    "href": "r.html#interpreting-the-results",
    "title": "Analysis of Variance in R",
    "section": "Interpreting the Results",
    "text": "Interpreting the Results\n\n\nAnalysis of Variance Table\n\nResponse: growth\n            Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nlight_level  2 454.58 227.292  16.685 0.0001536 ***\nResiduals   15 204.34  13.622                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nPr(&gt;F): This is the p-value from the F-test for light_level\nHere, our p-value is extremely small, so we can conclude that at least one of the groups has a different mean.\nThe question remains: which groups are different?"
  },
  {
    "objectID": "r.html#tukeys-hsd-test",
    "href": "r.html#tukeys-hsd-test",
    "title": "Analysis of Variance in R",
    "section": "Tukey’s HSD Test",
    "text": "Tukey’s HSD Test\nTukey’s honestly significant difference (HSD) test allows us to see which groups are significantly different from each other.\n\n# Tukey's HSD test\nTukeyHSD(model, conf.level = 0.95) # default to 95% confidence\n\nTukey’s HSD test will compare every combination of groups and determine which pairs are statistically different from each other."
  },
  {
    "objectID": "r.html#tukeys-hsd-test-results",
    "href": "r.html#tukeys-hsd-test-results",
    "title": "Analysis of Variance in R",
    "section": "Tukey’s HSD Test Results",
    "text": "Tukey’s HSD Test Results\n\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = growth ~ light_level, data = growth_long)\n\n$light_level\n               diff        lwr        upr     p adj\nlow-high -12.276667 -17.811651 -6.7416828 0.0001052\nmed-high  -5.358333 -10.893317  0.1766505 0.0584295\nmed-low    6.918333   1.383349 12.4533172 0.0141169\n\n\n\ndiff gives the difference in means for the two groups\np adj gives the p-value for the difference in two groups\nHere, we see that the low & high and low & medium groups are statiscially different, but not medium & high"
  },
  {
    "objectID": "r.html#one-way-vs.-two-way-anova",
    "href": "r.html#one-way-vs.-two-way-anova",
    "title": "Analysis of Variance in R",
    "section": "One-Way vs. Two-Way ANOVA",
    "text": "One-Way vs. Two-Way ANOVA\n\nIf two independent categorical variables need to be analyzed, this is referred to as a two-way ANOVA\n\nThis can be extended to more than two variables\n\nTwo-way ANOVA analyzes:\n\nEach independent variable\nHow they interact (if applicable)"
  },
  {
    "objectID": "r.html#two-way-anova-example",
    "href": "r.html#two-way-anova-example",
    "title": "Analysis of Variance in R",
    "section": "Two-Way Anova Example",
    "text": "Two-Way Anova Example\nConsider our original example.\n\nSay we have a second independent variable to analyze.\nNow we also want to see if the presence of fertilizer or not affects plant growth.\nWe also want to see if it interacts with light level."
  },
  {
    "objectID": "r.html#new-data-set",
    "href": "r.html#new-data-set",
    "title": "Analysis of Variance in R",
    "section": "New Data Set",
    "text": "New Data Set\n\ngrowth2 &lt;- data.frame(plant = c(1:6),\n                     fertilizer = rep(c(\"Y\",\"N\"),each=3),\n                     low = c(18.51,5.99,12.02,7.06,14.96,13.56),\n                     med = c(19.19,19.09,17.90,21.47,20.38,14.58),\n                     high = c(19.23,24.27,27.34,22.23,22.92,28.77))\ngrowth_long2 &lt;- pivot_longer(data = growth2,\n                            cols = \"low\":\"high\",\n                            names_to = \"light_level\",\n                            values_to = \"growth\")\nhead(growth_long2)\n\n# A tibble: 6 × 4\n  plant fertilizer light_level growth\n  &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;\n1     1 Y          low          18.5 \n2     1 Y          med          19.2 \n3     1 Y          high         19.2 \n4     2 Y          low           5.99\n5     2 Y          med          19.1 \n6     2 Y          high         24.3"
  },
  {
    "objectID": "r.html#two-way-anova-in-r",
    "href": "r.html#two-way-anova-in-r",
    "title": "Analysis of Variance in R",
    "section": "Two-Way ANOVA in R",
    "text": "Two-Way ANOVA in R\n\n# Run a two-way ANOVA\nmodel2 &lt;- aov(growth ~ light_level*fertilizer, data = growth_long2)\nsummary(model2)\n\n                       Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nlight_level             2  441.9  220.95  13.141 0.000949 ***\nfertilizer              1    0.3    0.32   0.019 0.893009    \nlight_level:fertilizer  2    1.4    0.71   0.042 0.958755    \nResiduals              12  201.8   16.81                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nlight_level:fertilizer gives the analysis for the interaction.\nThe p-value for the interaction is 0.915, indicating there is no evidence of an interaction between fertilizer and light level."
  },
  {
    "objectID": "r.html#caution-in-the-face-of-interaction",
    "href": "r.html#caution-in-the-face-of-interaction",
    "title": "Analysis of Variance in R",
    "section": "Caution in the face of interaction!",
    "text": "Caution in the face of interaction!\n\nIf interaction is determined statistically significant via an ANOVA, then generally we cannot make any assumptions about the individual effects\n\nEven if your individual effects show as significant, heed those results with caution if the interaction is significant\n\nA useful tool is an interaction plot\nThis helps us visualize how two effects (variables) are related."
  },
  {
    "objectID": "r.html#interaction-plot-no-interaction",
    "href": "r.html#interaction-plot-no-interaction",
    "title": "Analysis of Variance in R",
    "section": "Interaction Plot: No Interaction",
    "text": "Interaction Plot: No Interaction"
  },
  {
    "objectID": "r.html#interaction-plot-interaction-is-present",
    "href": "r.html#interaction-plot-interaction-is-present",
    "title": "Analysis of Variance in R",
    "section": "Interaction Plot: Interaction is Present",
    "text": "Interaction Plot: Interaction is Present\n\nBoth plots indicate interaction is present."
  },
  {
    "objectID": "r.html#creating-an-interaction-plot",
    "href": "r.html#creating-an-interaction-plot",
    "title": "Analysis of Variance in R",
    "section": "Creating an Interaction Plot",
    "text": "Creating an Interaction Plot\n\n# Interaction plot for light level and fertilizer\ninteraction.plot(x.factor = growth_long2$fertilizer,\n                 trace.factor = growth_long2$light_level, \n                 response = growth_long2$growth, fun = mean,\n                 xlab = \"Fertilizer\", ylab = \"Growth (cm)\", trace.label = \"Light Level\",\n                 col = c(\"#E69F00\",\"#0072B2\",\"#CC79A7\"), lty = 1)"
  },
  {
    "objectID": "r.html#creating-an-interaction-plot-1",
    "href": "r.html#creating-an-interaction-plot-1",
    "title": "Analysis of Variance in R",
    "section": "Creating an Interaction Plot",
    "text": "Creating an Interaction Plot\n\nThis interaction plot shows little to no interaction between fertilizer and light level, which was confirmed by the ANOVA."
  },
  {
    "objectID": "r.html#tukeys-hsd-test-for-two-way-anova",
    "href": "r.html#tukeys-hsd-test-for-two-way-anova",
    "title": "Analysis of Variance in R",
    "section": "Tukey’s HSD Test for Two-Way ANOVA",
    "text": "Tukey’s HSD Test for Two-Way ANOVA\nTukey’s HSD test can also be used with a two-way ANOVA.\n\n# Tukey's HSD test for a two-way ANOVA\nTukeyHSD(model2, conf.level = 0.95)\n\nI didn’t include the output here, because it is long!\n\nTukey’s HSD test can give great further insight, especially when your interaction is significant"
  },
  {
    "objectID": "r.html#other-anova-notes",
    "href": "r.html#other-anova-notes",
    "title": "Analysis of Variance in R",
    "section": "Other ANOVA Notes…",
    "text": "Other ANOVA Notes…\n\nIf you ever encounter a scenario where residual degrees of freedom (df) are equal to or smaller than any main effect or interaction, ANOVA results won’t be reliable\nIf you are ever worried that variances between groups aren’t equal, the leveneTest() function can test for equality of variances\nIf you have a scenario where you have an unbalanced experiment or missing data points, Type III sums of squares should be used in the ANOVA.\n\nThe aov() function we used uses Type I sums of squares.\nThe library car has an Anova() function with Type III capabilities."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ANOVA Workshops for R and SAS",
    "section": "",
    "text": "Analysis of Variance in R\n\n\n\nNicole Harms\n\n\nFeb 9, 2026\n\n\n\n\n\n\n\n\nNo matching items"
  }
]